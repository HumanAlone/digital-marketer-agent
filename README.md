# AI Agent - Цифровой маркетолог для Яндекс.Директ 

## Описание
LangChain агент с интеграцией MCP (Model Context Protocol) инструментов для анализа рекламных кампаний Яндекс.Директ. Агент использует LLM (Large Language Model) для планирования и выполнения аналитических задач, предоставляя структурированные рекомендации по оптимизации рекламных кампаний.

## Назначение
Агент выступает в качестве интеллектуального интерфейса между пользователем (через Telegram бота) и инструментами анализа данных (через MCP сервер). Его основная задача - интерпретировать запросы пользователя, выбирать подходящие инструменты анализа и предоставлять понятные, обоснованные рекомендации.

## Архитектура

### Технологический стек
- **Framework**: LangChain + LangChain Classic
- **LLM**: OpenAI GPT (поддерживает кастомные эндпоинты)
- **Инструменты**: MCP (Model Context Protocol) инструменты через HTTP
- **Оркестратор**: AgentExecutor с OpenAI Tools Agent
- **HTTP клиент**: requests (синхронный)
- **Конфигурация**: python-dotenv

## Ключевые компоненты

### 1. MCPClient
HTTP клиент для взаимодействия с MCP сервером.

**Основные возможности:**
- Вызов инструментов через JSON-RPC 2.0
- Обработка streamable HTTP ответов
- Преобразование JSON ответов в читаемый текст
- Обработка ошибок соединения

### 2. Инструменты агента

- **get_campaign_performance** - Получает данные по эффективности кампании за указанный период
- **analyze_campaign_health** - Анализирует здоровье кампании по бизнес-правилам и целевым показателям
- **generate_daily_report** - Генерирует сводный ежедневный отчет по нескольким кампаниям
- **calculate_scenarios** - Рассчитывает финансовые сценарии для достижения целевых конверсий
- **calculate_cpa** - Рассчитывает стоимость привлечения клиента на основе расходов и конверсий
- **test_connection** - Проверяет работоспособность MCP сервера и доступность инструментов

### 3. Настройка и запуск
1. Установка зависимостей
```bash
pip install -r requirements.txt
```
2. Конфигурация переменных окружения
Создайте файл .env:

```env
# Обязательные
LLM_API_KEY=Ваш ключ для ЛЛМ
LLM_API_BASE=Урл для вашей ЛЛМ

# Опциональные
LLM_MODEL=gpt-4-turbo-preview
MCP_URL=http://localhost:8000
SERVER_HOST=0.0.0.0
SERVER_PORT=10000
LOG_LEVEL=INFO
```

3. Запуск агента
```bash
python start_a2a.py
```

Агент будет доступен по адресу: http://localhost:10000

### 4. Структура проекта
```
DIGITAL-MARKETER-AGENT-VER2/
├── src/                        # Основной код агента
│   ├── a2a_wrapper.py          # Обёртка для взаимодействия с A2A API
│   ├── agent_task_manager.py   # Менеджер задач агента
│   ├── langchain_agent.py      # Реализация агента на LangChain
│   └── start_a2a.py            # Точка входа для запуска сервера
├── .env.example                # Пример файла .env
├── .gitignore                  # Файлы, исключённые из Git
├── Dockerfile                  # Для сборки контейнера
├── README.md                   # Документация
└── requirements.txt            # Зависимости Python
```